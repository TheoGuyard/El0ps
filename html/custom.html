<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Examples" href="examples/examples.html" /><link rel="prev" title="Getting started" href="getting_started.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Custom instances - El0ps 0.0.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">El0ps 0.0.3 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">El0ps 0.0.3 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Custom instances</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="examples/examples.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/custom-datafit.html">Custom datafit</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/custom-penalty.html">Custom penalty</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/custom-estimator.html">Custom estimator</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api/api.html">API references</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API references</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="api/compilation.html"><code class="docutils literal notranslate"><span class="pre">el0ps.compilation</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of el0ps.compilation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.compilation.CompilableClass.html">el0ps.compilation.CompilableClass</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.compilation.compiled_clone.html">el0ps.compilation.compiled_clone</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api/datafit.html"><code class="docutils literal notranslate"><span class="pre">el0ps.datafit</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of el0ps.datafit</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.datafit.BaseDatafit.html">el0ps.datafit.BaseDatafit</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.datafit.MipDatafit.html">el0ps.datafit.MipDatafit</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.datafit.KullbackLeibler.html">el0ps.datafit.KullbackLeibler</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.datafit.Leastsquares.html">el0ps.datafit.Leastsquares</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.datafit.Logcosh.html">el0ps.datafit.Logcosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.datafit.Logistic.html">el0ps.datafit.Logistic</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.datafit.Squaredhinge.html">el0ps.datafit.Squaredhinge</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api/estimator.html"><code class="docutils literal notranslate"><span class="pre">el0ps.estimator</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of el0ps.estimator</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.estimator.L0Estimator.html">el0ps.estimator.L0Estimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.estimator.L0Classifier.html">el0ps.estimator.L0Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.estimator.L0L1Classifier.html">el0ps.estimator.L0L1Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.estimator.L0L2Classifier.html">el0ps.estimator.L0L2Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.estimator.L0L1L2Classifier.html">el0ps.estimator.L0L1L2Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.estimator.L0Regressor.html">el0ps.estimator.L0Regressor</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.estimator.L0L1Regressor.html">el0ps.estimator.L0L1Regressor</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.estimator.L0L2Regressor.html">el0ps.estimator.L0L2Regressor</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.estimator.L0L1L2Regressor.html">el0ps.estimator.L0L1L2Regressor</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.estimator.L0SVC.html">el0ps.estimator.L0SVC</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.estimator.L0L1SVC.html">el0ps.estimator.L0L1SVC</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.estimator.L0L2SVC.html">el0ps.estimator.L0L2SVC</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.estimator.L0L1L2SVC.html">el0ps.estimator.L0L1L2SVC</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api/path.html"><code class="docutils literal notranslate"><span class="pre">el0ps.path</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of el0ps.path</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.path.Path.html">el0ps.path.Path</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api/penalty.html"><code class="docutils literal notranslate"><span class="pre">el0ps.penalty</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of el0ps.penalty</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.BasePenalty.html">el0ps.penalty.BasePenalty</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.SymmetricPenalty.html">el0ps.penalty.SymmetricPenalty</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.MipPenalty.html">el0ps.penalty.MipPenalty</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.Bigm.html">el0ps.penalty.Bigm</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.BigmL1norm.html">el0ps.penalty.BigmL1norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.BigmL2norm.html">el0ps.penalty.BigmL2norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.BigmPositiveL1norm.html">el0ps.penalty.BigmPositiveL1norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.BigmPositiveL2norm.html">el0ps.penalty.BigmPositiveL2norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.Bounds.html">el0ps.penalty.Bounds</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.L1L2norm.html">el0ps.penalty.L1L2norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.L1norm.html">el0ps.penalty.L1norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.L2norm.html">el0ps.penalty.L2norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.PositiveL1norm.html">el0ps.penalty.PositiveL1norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.PositiveL2norm.html">el0ps.penalty.PositiveL2norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.compute_param_slope_pos.html">el0ps.penalty.compute_param_slope_pos</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.penalty.compute_param_slope_neg.html">el0ps.penalty.compute_param_slope_neg</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api/solver.html"><code class="docutils literal notranslate"><span class="pre">el0ps.solver</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of el0ps.solver</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.solver.Status.html">el0ps.solver.Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.solver.Result.html">el0ps.solver.Result</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.solver.BaseSolver.html">el0ps.solver.BaseSolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.solver.BoundSolver.html">el0ps.solver.BoundSolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.solver.BnbSolver.html">el0ps.solver.BnbSolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.solver.MipSolver.html">el0ps.solver.MipSolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.solver.OaSolver.html">el0ps.solver.OaSolver</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api/utils.html"><code class="docutils literal notranslate"><span class="pre">el0ps.utils</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of el0ps.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/generated/el0ps.utils.compute_lmbd_max.html">el0ps.utils.compute_lmbd_max</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="news.html">What’s new</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/custom.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="custom-instances">
<span id="custom"></span><h1>Custom instances<a class="headerlink" href="#custom-instances" title="Link to this heading">¶</a></h1>
<p>In addition to built-in instances of datafit, penalty, and estimators natively implemented in <code class="docutils literal notranslate"><span class="pre">el0ps</span></code>, the package provides a flexible workflow allowing for <strong>users-defined</strong> instances of these objects to better fit application needs.
This process is articulated around the following template classes:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/generated/el0ps.datafit.BaseDatafit.html#el0ps.datafit.BaseDatafit" title="el0ps.datafit.BaseDatafit"><code class="xref py py-class docutils literal notranslate"><span class="pre">el0ps.datafit.BaseDatafit</span></code></a> to define datafit functions,</p></li>
<li><p><a class="reference internal" href="api/generated/el0ps.penalty.BasePenalty.html#el0ps.penalty.BasePenalty" title="el0ps.penalty.BasePenalty"><code class="xref py py-class docutils literal notranslate"><span class="pre">el0ps.penalty.BasePenalty</span></code></a> to define penalty functions,</p></li>
<li><p><a class="reference internal" href="api/generated/el0ps.estimator.L0Estimator.html#el0ps.estimator.L0Estimator" title="el0ps.estimator.L0Estimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">el0ps.estimator.L0Estimator</span></code></a> to define L0-problem-based estimators based.</p></li>
</ul>
<p>When properly implemented, derived classes are fully compatible with all the utilities provided by <code class="docutils literal notranslate"><span class="pre">el0ps</span></code> without further requirements.
This section explains how to proceed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Examples of user-defined datafit, penalty and estimators instantiation are given in the <a class="reference internal" href="examples/examples.html#examples"><span class="std std-ref">Examples</span></a> section.</p>
</div>
<section id="mathematical-background">
<span id="custom-maths"></span><h2>Mathematical background<a class="headerlink" href="#mathematical-background" title="Link to this heading">¶</a></h2>
<p>Defining custom datafit, penalty and estimators requires some mathematical background on convex analysis.
In particular, given a function <span class="math notranslate nohighlight">\(\omega: \mathbb{R}^d \rightarrow \mathbb{R} \cup \{+\infty\}\)</span>, the notions of properness, lower-semicontinuity, convexity, coercivity, Lipschitz-continuity, gradient <span class="math notranslate nohighlight">\(\nabla\omega\)</span>, subdifferential <span class="math notranslate nohighlight">\(\partial\omega\)</span>, convex conjugate <span class="math notranslate nohighlight">\(\omega^{\ast}\)</span>, and proximal operator <span class="math notranslate nohighlight">\(\mathrm{prox}_{\omega}\)</span> will be used in the rest of this section.
We refer users to the following monograph for a comprehensive introduction and definition of these notions.</p>
<blockquote>
<div><p>Beck, A. (2017). First-order methods in optimization. SIAM.</p>
</div></blockquote>
</section>
<section id="custom-datafit-functions">
<span id="custom-datafit"></span><h2>Custom datafit functions<a class="headerlink" href="#custom-datafit-functions" title="Link to this heading">¶</a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">el0ps</span></code>, datafit objects represent mathematical functions defined as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f: \mathbb{R}^m \rightarrow \mathbb{R} \cup \{+\infty\}\]</div>
</div>
<p>which are required to be proper, lower-semicontinuous, convex and differentiable with a Lipschitz-continuous gradient.
Any datafit function not natively provided by <code class="docutils literal notranslate"><span class="pre">el0ps</span></code> but fulfilling these specifications can be implemented to benefit from all the package features.
This is done by deriving from the <a class="reference internal" href="api/generated/el0ps.datafit.BaseDatafit.html#el0ps.datafit.BaseDatafit" title="el0ps.datafit.BaseDatafit"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDatafit</span></code></a> class, which requires implementing the following methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">value(self,</span> <span class="pre">w:</span> <span class="pre">NDArray)</span> <span class="pre">-&gt;</span> <span class="pre">float</span></code> : value of <span class="math notranslate nohighlight">\(f(\mathbf{w})\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">conjugate(self,</span> <span class="pre">w:</span> <span class="pre">NDArray)</span> <span class="pre">-&gt;</span> <span class="pre">float</span></code> : value of <span class="math notranslate nohighlight">\(f^{\ast}(\mathbf{w})\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gradient(self,</span> <span class="pre">w:</span> <span class="pre">NDArray)</span> <span class="pre">-&gt;</span> <span class="pre">NDArray</span></code> : value of <span class="math notranslate nohighlight">\(\nabla f(\mathbf{w})\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gradient_lipschitz_constant(self)</span> <span class="pre">-&gt;</span> <span class="pre">float</span></code> : Lipschitz constant of <span class="math notranslate nohighlight">\(\nabla f\)</span>.</p></li>
</ul>
<p>Once done, users can fully enjoy all features provided by <code class="docutils literal notranslate"><span class="pre">el0ps</span></code> with their custom datafit function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Datafit functions defined as explained above can be handled by the <a class="reference internal" href="api/generated/el0ps.solver.BnbSolver.html#el0ps.solver.BnbSolver" title="el0ps.solver.BnbSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">BnbSolver</span></code></a> and <a class="reference internal" href="api/generated/el0ps.solver.OaSolver.html#el0ps.solver.OaSolver" title="el0ps.solver.OaSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">OaSolver</span></code></a> solvers.
To be compatible with the <a class="reference internal" href="api/generated/el0ps.solver.MipSolver.html#el0ps.solver.MipSolver" title="el0ps.solver.MipSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">MipSolver</span></code></a> solver, they must implement one additional method, as explained in the <a class="reference internal" href="#custom-mip"><span class="std std-ref">MIP solver</span></a> section.</p>
</div>
</section>
<section id="custom-penalty-functions">
<span id="custom-penalty"></span><h2>Custom penalty functions<a class="headerlink" href="#custom-penalty-functions" title="Link to this heading">¶</a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">el0ps</span></code>, penalty objects represent mathematical functions defined as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[h: \mathbb{R}^n \rightarrow \mathbb{R} \cup \{+\infty\}\]</div>
</div>
<p>which are separable as <span class="math notranslate nohighlight">\(h(\mathbf{x}) = \sum_{i=1}^n h_i(x_i)\)</span> for all <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R^n}\)</span>, where each splitting term <span class="math notranslate nohighlight">\(h_i : \mathbb{R} \rightarrow \mathbb{R} \cup \{+\infty\}\)</span> is required to be proper, lower-semicontinuous, convex, coercive, and such that <span class="math notranslate nohighlight">\(h_i(x_i) \geq h_i(0) = 0\)</span>.
Any penalty function not natively provided by <code class="docutils literal notranslate"><span class="pre">el0ps</span></code> but fulfilling these specifications can be implemented to benefit from all the package features.
This is done by deriving from the <a class="reference internal" href="api/generated/el0ps.penalty.BasePenalty.html#el0ps.penalty.BasePenalty" title="el0ps.penalty.BasePenalty"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePenalty</span></code></a> class, which requires implementing the following methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">value(self,</span> <span class="pre">i:</span> <span class="pre">int,</span> <span class="pre">x:</span> <span class="pre">float)</span> <span class="pre">-&gt;</span> <span class="pre">float</span></code> : value of <span class="math notranslate nohighlight">\(h_i(x)\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">conjugate(self,</span> <span class="pre">i:</span> <span class="pre">int,</span> <span class="pre">x:</span> <span class="pre">float)</span> <span class="pre">-&gt;</span> <span class="pre">float</span></code> : value of <span class="math notranslate nohighlight">\(h_i^{\ast}(x)\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prox(self,</span> <span class="pre">i:</span> <span class="pre">int,</span> <span class="pre">x:</span> <span class="pre">float,</span> <span class="pre">eta:</span> <span class="pre">float)</span> <span class="pre">-&gt;</span> <span class="pre">float</span></code> : value of <span class="math notranslate nohighlight">\(\mathrm{prox}_{\eta h_i}(x)\)</span> with <span class="math notranslate nohighlight">\(\eta &gt; 0\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subdiff(self,</span> <span class="pre">i:</span> <span class="pre">int,</span> <span class="pre">x:</span> <span class="pre">float)</span> <span class="pre">-&gt;</span> <span class="pre">NDArray</span></code> : bounds of the interval <span class="math notranslate nohighlight">\(\partial h_i(x)\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">conjugate_subdiff(self,</span> <span class="pre">i:</span> <span class="pre">int,</span> <span class="pre">x:</span> <span class="pre">float)</span> <span class="pre">-&gt;</span> <span class="pre">NDArray</span></code> : bounds of the interval <span class="math notranslate nohighlight">\(\partial h_i^{\ast}(x)\)</span>.</p></li>
</ul>
<p>Once done, users can fully enjoy all features provided by <code class="docutils literal notranslate"><span class="pre">el0ps</span></code> with their custom penalty function.</p>
<p><strong>Improving numerical efficiency:</strong> Some features of <code class="docutils literal notranslate"><span class="pre">el0ps</span></code> involve the quantities</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    \tau_i^+(\lambda) &amp;= \sup\{x \in \mathbb{R} : h_i^{\ast}(x) \leq \lambda\} \\
    \tau_i^-(\lambda) &amp;= \inf\{x \in \mathbb{R} : h_i^{\ast}(x) \leq \lambda\} \\
\end{align*}\end{split}\]</div>
</div>
<p>associated with each splitting term <span class="math notranslate nohighlight">\(h_i\)</span> and depending on the L0-norm weight parameter <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span>.
By default, these values are automatically approximated in classes deriving from <a class="reference internal" href="api/generated/el0ps.penalty.BasePenalty.html#el0ps.penalty.BasePenalty" title="el0ps.penalty.BasePenalty"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePenalty</span></code></a> using the iterative procedure implemented in the <a class="reference internal" href="api/generated/el0ps.penalty.compute_param_slope_pos.html#el0ps.penalty.compute_param_slope_pos" title="el0ps.penalty.compute_param_slope_pos"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compute_param_slope_pos()</span></code></a> and <a class="reference internal" href="api/generated/el0ps.penalty.compute_param_slope_neg.html#el0ps.penalty.compute_param_slope_neg" title="el0ps.penalty.compute_param_slope_neg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compute_param_slope_neg()</span></code></a> methods.
To improve performance, users can provide a closed form expression of these values by overloading the following methods of the <a class="reference internal" href="api/generated/el0ps.penalty.BasePenalty.html#el0ps.penalty.BasePenalty" title="el0ps.penalty.BasePenalty"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePenalty</span></code></a> class:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">param_slope_pos(self,</span> <span class="pre">i:</span> <span class="pre">int,</span> <span class="pre">lmbd:</span> <span class="pre">float)</span> <span class="pre">-&gt;</span> <span class="pre">float</span></code> : value of <span class="math notranslate nohighlight">\(\tau_i^+(\lambda)\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">param_slope_neg(self,</span> <span class="pre">i:</span> <span class="pre">int,</span> <span class="pre">lmbd:</span> <span class="pre">float)</span> <span class="pre">-&gt;</span> <span class="pre">float</span></code> : value of <span class="math notranslate nohighlight">\(\tau_i^-(\lambda)\)</span>.</p></li>
</ul>
<p>Doing so avoid the use of the iterative procedure every time these values are required.
To ease this process in case of <strong>even</strong> penalty functions for which <span class="math notranslate nohighlight">\(\tau_i^+(\lambda) = -\tau_i^-(\lambda)\)</span>, classes deriving from <a class="reference internal" href="api/generated/el0ps.penalty.BasePenalty.html#el0ps.penalty.BasePenalty" title="el0ps.penalty.BasePenalty"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePenalty</span></code></a> can also inherit from the <a class="reference internal" href="api/generated/el0ps.penalty.SymmetricPenalty.html#el0ps.penalty.SymmetricPenalty" title="el0ps.penalty.SymmetricPenalty"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymmetricPenalty</span></code></a> class.
In this case, only the following method needs to be implemented:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">param_slope(self,</span> <span class="pre">i:</span> <span class="pre">int,</span> <span class="pre">lmbd:</span> <span class="pre">float)</span> <span class="pre">-&gt;</span> <span class="pre">float</span></code> : value of <span class="math notranslate nohighlight">\(\tau_i^+(\lambda) = -\tau_i^-(\lambda)\)</span></p></li>
</ul>
<p>and the functions <code class="docutils literal notranslate"><span class="pre">param_slope_pos</span></code> and <code class="docutils literal notranslate"><span class="pre">param_slope_neg</span></code> are automatically linked to its output.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Penalty functions defined as explained above can be handled by the <a class="reference internal" href="api/generated/el0ps.solver.BnbSolver.html#el0ps.solver.BnbSolver" title="el0ps.solver.BnbSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">BnbSolver</span></code></a> and <a class="reference internal" href="api/generated/el0ps.solver.OaSolver.html#el0ps.solver.OaSolver" title="el0ps.solver.OaSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">OaSolver</span></code></a> solvers.
To be compatible with the <a class="reference internal" href="api/generated/el0ps.solver.MipSolver.html#el0ps.solver.MipSolver" title="el0ps.solver.MipSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">MipSolver</span></code></a> solver, they must implement one additional method, as explained in the <a class="reference internal" href="#custom-mip"><span class="std std-ref">MIP solver</span></a> section.</p>
</div>
</section>
<section id="custom-estimators">
<span id="custom-estimator"></span><h2>Custom estimators<a class="headerlink" href="#custom-estimators" title="Link to this heading">¶</a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">el0ps</span></code>, estimator objects represent solutions of L0-regularized problems expressed as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\textstyle\min_{\mathbf{x} \in \mathbb{R}^n} f(\mathbf{Ax}) + \lambda\|\mathbf{x}\|_0 + h(\mathbf{x})\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(h\)</span> are required to verify the assumptions of datafit and penalty functions as explained in the <a class="reference internal" href="#custom-datafit"><span class="std std-ref">Custom datafit functions</span></a> and <a class="reference internal" href="#custom-penalty"><span class="std std-ref">Custom penalty functions</span></a> sections.
Any estimator not natively provided by <code class="docutils literal notranslate"><span class="pre">el0ps</span></code> but fulfilling these specifications can be implemented in the package to benefit from all its features.
This is done by deriving from the <a class="reference internal" href="api/generated/el0ps.estimator.L0Estimator.html#el0ps.estimator.L0Estimator" title="el0ps.estimator.L0Estimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">L0Estimator</span></code></a> class, which only requires implementing a constructor  <code class="docutils literal notranslate"><span class="pre">__init__(self,</span> <span class="pre">lmbd:</span> <span class="pre">float,</span> <span class="pre">*args,</span> <span class="pre">**kwargs)</span> <span class="pre">-&gt;</span> <span class="pre">None</span></code> for the class which specifies the value of <span class="math notranslate nohighlight">\(\lambda\)</span> as well as potential parameters for the functions <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(h\)</span>.
This constructor <strong>must</strong> end with the call to the super constructor of <a class="reference internal" href="api/generated/el0ps.estimator.L0Estimator.html#el0ps.estimator.L0Estimator" title="el0ps.estimator.L0Estimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">L0Estimator</span></code></a> as</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">super().__init__(datafit,</span> <span class="pre">penalty,</span> <span class="pre">lmbd)</span></code></p></li>
</ul>
<p>for some <code class="docutils literal notranslate"><span class="pre">datafit</span></code> object derived from <a class="reference internal" href="api/generated/el0ps.datafit.BaseDatafit.html#el0ps.datafit.BaseDatafit" title="el0ps.datafit.BaseDatafit"><code class="xref py py-class docutils literal notranslate"><span class="pre">el0ps.datafit.BaseDatafit</span></code></a>, some <code class="docutils literal notranslate"><span class="pre">penalty</span></code> object derived from <a class="reference internal" href="api/generated/el0ps.penalty.BasePenalty.html#el0ps.penalty.BasePenalty" title="el0ps.penalty.BasePenalty"><code class="xref py py-class docutils literal notranslate"><span class="pre">el0ps.penalty.BasePenalty</span></code></a>, and some float <code class="docutils literal notranslate"><span class="pre">lmbd</span></code>.
Once done, users can fully enjoy all features provided by <code class="docutils literal notranslate"><span class="pre">el0ps</span></code> with their custom estimator based on L0-norm problem.</p>
</section>
<section id="compilable-classes">
<span id="custom-compilation"></span><h2>Compilable classes<a class="headerlink" href="#compilable-classes" title="Link to this heading">¶</a></h2>
<p>Custom loss and penalty functions defined by the user can derive from the <a class="reference internal" href="api/generated/el0ps.compilation.CompilableClass.html#el0ps.compilation.CompilableClass" title="el0ps.compilation.CompilableClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompilableClass</span></code></a> class to take advantage of just-in-time compilation provided by <a class="reference external" href="https://numba.org">numba</a>.
This requires that all operations performed by the class are compatible with <a class="reference external" href="https://numba.readthedocs.io/en/stable/user/5minguide.html#will-numba-work-for-my-code">numba operations</a>.
Moreover, users need to instantiate two additional methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_spec(self)</span> <span class="pre">-&gt;</span> <span class="pre">tuple</span></code> : returns a tuple where each element corresponds to a tuple referring to one of the class attribute defined in the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> function of the class and specifying its name as a string as well as its <a class="reference external" href="https://numba.readthedocs.io/en/stable/reference/types.html">numba type</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">params_to_dict(self)</span> <span class="pre">-&gt;</span> <span class="pre">dict</span></code> : returns a dictionary where each key-value association refers to one of the class attribute defined in the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> function of the class and specifies its name as a string as well as its value.</p></li>
</ul>
<p>This functionality inspired from a similar one implemented in <a class="reference external" href="https://contrib.scikit-learn.org/skglm/stable/index.html">skglm</a>.</p>
</section>
<section id="mip-solver">
<span id="custom-mip"></span><h2>MIP solver<a class="headerlink" href="#mip-solver" title="Link to this heading">¶</a></h2>
<p>Implementing custom datafit and penalty functions as explained in the previous sections allows benefiting from all the features provided by <code class="docutils literal notranslate"><span class="pre">el0ps</span></code>, provided that the resulting L0-regularized problems are tackled via either the <a class="reference internal" href="api/generated/el0ps.solver.BnbSolver.html#el0ps.solver.BnbSolver" title="el0ps.solver.BnbSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">BnbSolver</span></code></a> or the <a class="reference internal" href="api/generated/el0ps.solver.OaSolver.html#el0ps.solver.OaSolver" title="el0ps.solver.OaSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">OaSolver</span></code></a> solvers.
Users may also want to leverage the <a class="reference internal" href="api/generated/el0ps.solver.MipSolver.html#el0ps.solver.MipSolver" title="el0ps.solver.MipSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">MipSolver</span></code></a> solver to address these problems.
This solver calls a generic mixed-integer programming optimizer on a model formulated as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
    \begin{array}{ll}
        \min &amp; f_{\mathrm{val}} + \lambda \mathbf{1}^{\top}\mathbf{z} + h_{\mathrm{val}} \\
        \text{s.t.} &amp; \mathbf{w} = \mathbf{Ax} \\
        &amp; f_{\mathrm{val}} \geq f(\mathbf{w}) \\
        &amp; h_{\mathrm{val}} \geq
        \begin{cases}
            h(\mathbf{x}) &amp; \text{if } z_i = 0 \implies x_i = 0 \quad \forall i \in \{1,\dots,n\} \\
            +\infty &amp; \text{otherwise}
        \end{cases} \\
        &amp; f_{\mathrm{val}} \in \mathbb{R} \cup \{+\infty\}, \ g_{\mathrm{val}} \in \mathbb{R} \cup \{+\infty\} \\
        &amp; \mathbf{x} \in \mathbb{R}^n, \ \mathbf{w} \in \mathbb{R}^m, \ \mathbf{z} \in \{0,1\}^n \\
    \end{array}
\right.\end{split}\]</div>
</div>
<p>where the scalar variables <span class="math notranslate nohighlight">\(f_{\mathrm{val}}\)</span> and <span class="math notranslate nohighlight">\(h_{\mathrm{val}}\)</span> model the epigraph of the functions <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(h\)</span>, respectively, and where a binary variable <span class="math notranslate nohighlight">\(\mathbf{z} \in \{0,1\}^n\)</span> encodes the nullity of the entries in <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^n\)</span> to linearize the L0-norm expression.</p>
<p><strong>Using custom datafit:</strong> To use the mixed-integer programming solver with custom a datafit function, it must derive from the <a class="reference internal" href="api/generated/el0ps.datafit.MipDatafit.html#el0ps.datafit.MipDatafit" title="el0ps.datafit.MipDatafit"><code class="xref py py-class docutils literal notranslate"><span class="pre">MipDatafit</span></code></a> class.
This requires implementing the function</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bind_model(self,</span> <span class="pre">model:</span> <span class="pre">pyomo.kernel.block)</span> <span class="pre">-&gt;</span> <span class="pre">None</span></code></p></li>
</ul>
<p>which has the purpose of adding the constraint</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_{\mathrm{val}} \geq f(\mathbf{w})\]</div>
</div>
<p>to the <code class="docutils literal notranslate"><span class="pre">model</span></code> object.
The latter is a <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/api/pyomo.core.kernel.block.block.html">pyomo kernel block</a> instance already containing the attributes <code class="docutils literal notranslate"><span class="pre">model.f</span></code>, <code class="docutils literal notranslate"><span class="pre">model.w</span></code> and <code class="docutils literal notranslate"><span class="pre">model.M</span></code> of the mixed-integer programming model that can be used to model this constraint.</p>
<p><strong>Using custom penalties:</strong> To use the mixed-integer programming solver with custom a penalty function, it must derive from the <a class="reference internal" href="api/generated/el0ps.penalty.MipPenalty.html#el0ps.penalty.MipPenalty" title="el0ps.penalty.MipPenalty"><code class="xref py py-class docutils literal notranslate"><span class="pre">MipPenalty</span></code></a> class.
This requires implementing the function</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bind_model(self,</span> <span class="pre">model:</span> <span class="pre">pyomo.kernel.block)</span> <span class="pre">-&gt;</span> <span class="pre">None</span></code></p></li>
</ul>
<p>which has the purpose of adding the constraint</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}h_{\mathrm{val}} \geq
\begin{cases}
    h(\mathbf{x}) &amp; \text{if } z_i = 0 \implies x_i = 0 \quad \forall i \in \{1,\dots,n\} \\
    +\infty &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
</div>
<p>to the <code class="docutils literal notranslate"><span class="pre">model</span></code> object.
The latter is a <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/api/pyomo.core.kernel.block.block.html">pyomo kernel block</a> instance already containing the attributes <code class="docutils literal notranslate"><span class="pre">model.h</span></code>, <code class="docutils literal notranslate"><span class="pre">model.x</span></code>, <code class="docutils literal notranslate"><span class="pre">model.z</span></code> and <code class="docutils literal notranslate"><span class="pre">model.N</span></code> of the mixed-integer programming model that can be used to model this constraint.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="examples/examples.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Examples</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="getting_started.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Getting started</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Theo Guyard
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Custom instances</a><ul>
<li><a class="reference internal" href="#mathematical-background">Mathematical background</a></li>
<li><a class="reference internal" href="#custom-datafit-functions">Custom datafit functions</a></li>
<li><a class="reference internal" href="#custom-penalty-functions">Custom penalty functions</a></li>
<li><a class="reference internal" href="#custom-estimators">Custom estimators</a></li>
<li><a class="reference internal" href="#compilable-classes">Compilable classes</a></li>
<li><a class="reference internal" href="#mip-solver">MIP solver</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=47de8214"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>